###
# API Tests para SocgerFleet
###

# Variables
@baseUrl = http://localhost:3000
@contentType = application/json

# Tokens
@userToken  = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InRlc3RAc29jZ2VyZmxlZXQuY29tIiwic3ViIjoyLCJ1c2VybmFtZSI6InRlc3R1c2VyIiwicm9sZXMiOlt7ImlkIjoyLCJuYW1lIjoidXNlciIsImRlc2NyaXB0aW9uIjoiVXN1YXJpbyBiw4PCoXNpY28gZGVsIHNpc3RlbWEiLCJjcmVhdGVkQXQiOiIyMDI1LTA4LTI4VDA1OjEyOjMzLjM2NloiLCJ1cGRhdGVkQXQiOiIyMDI1LTA4LTI4VDA1OjEyOjMzLjQwMFoifV0sImlhdCI6MTc1NjQ4MjQyNiwiZXhwIjoxNzU2NTY4ODI2fQ.9IuaHpKeE0JtloNVcdNT8McqDoe8FV2N6iWEpwthv4s
@adminToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFkbWluQHNvY2dlcmZsZWV0LmNvbSIsInN1YiI6MSwidXNlcm5hbWUiOiJhZG1pbiIsInJvbGVzIjpbeyJpZCI6MSwibmFtZSI6ImFkbWluIiwiZGVzY3JpcHRpb24iOiJBZG1pbmlzdHJhZG9yIGRlbCBzaXN0ZW1hIGNvbiB0b2RvcyBsb3MgcGVybWlzb3MiLCJjcmVhdGVkQXQiOiIyMDI1LTA4LTI4VDA1OjEyOjMzLjM2NloiLCJ1cGRhdGVkQXQiOiIyMDI1LTA4LTI4VDA1OjEyOjMzLjQwMFoifV0sImlhdCI6MTc1NjUzMjQ4MCwiZXhwIjoxNzU2NjE4ODgwfQ.NfngGVV3tupJ-sIXfD327gXGLh4fsabayelnsLOhlNk

###
# 1. REGISTRO DE USUARIO
POST {{baseUrl}}/auth/register
Content-Type: {{contentType}}

{
  "username": "testuser",
  "email": "test@socgerfleet.com",
  "password": "123456",
  "firstName": "Usuario",
  "lastName": "Prueba"
}

###
# 2. LOGIN DE USUARIO
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "test@socgerfleet.com",
  "password": "123456"
}

###
# 3. LOGIN ADMIN (usuario por defecto)
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "admin@socgerfleet.com",
  "password": "admin123"
}

###
# 4. OBTENER PERFIL (requiere token)
# Token obtenido del registro/login
POST {{baseUrl}}/auth/profile
Authorization: Bearer {{userToken}}
Content-Type: {{contentType}}

###
# 4b. OBTENER PERFIL ADMIN
POST {{baseUrl}}/auth/profile
Authorization: Bearer {{adminToken}}
Content-Type: {{contentType}}

###
# 5. LISTAR TODOS LOS USUARIOS
GET {{baseUrl}}/users
Authorization: Bearer {{adminToken}}

###
# 6. OBTENER USUARIO POR ID
GET {{baseUrl}}/users/1
Authorization: Bearer {{adminToken}}

###
# 7. CREAR NUEVO USUARIO (ADMIN)
POST {{baseUrl}}/users
Authorization: Bearer {{adminToken}}
Content-Type: {{contentType}}

{
  "username": "nuevouser",
  "email": "nuevo@socgerfleet.com",
  "password": "123456",
  "firstName": "Nuevo",
  "lastName": "Usuario",
  "roleIds": [2]
}

###
# 8. ACTUALIZAR USUARIO (ADMIN)
PATCH {{baseUrl}}/users/2
Authorization: Bearer {{adminToken}}
Content-Type: {{contentType}}

{
  "firstName": "Nombre Actualizado",
  "isActive": true
}

###
# 9. ASIGNAR ROL A USUARIO (ADMIN)
POST {{baseUrl}}/users/2/roles/1
Authorization: Bearer {{adminToken}}

###
# 10. QUITAR ROL DE USUARIO (ADMIN)
DELETE {{baseUrl}}/users/2/roles/1
Authorization: Bearer {{adminToken}}

###
# 11. ELIMINAR USUARIO (ADMIN)
DELETE {{baseUrl}}/users/3
Authorization: Bearer {{adminToken}}

###
# 12. LISTAR TODOS LOS ROLES (ADMIN)
GET {{baseUrl}}/roles
Authorization: Bearer {{adminToken}}

###
# 13. OBTENER ROL POR ID (ADMIN)
GET {{baseUrl}}/roles/1
Authorization: Bearer {{adminToken}}

###
# 14. CREAR NUEVO ROL (ADMIN)
POST {{baseUrl}}/roles
Authorization: Bearer {{adminToken}}
Content-Type: {{contentType}}

{
  "name": "editor",
  "description": "Editor de contenido"
}

###
# 15. ACTUALIZAR ROL (ADMIN)
PATCH {{baseUrl}}/roles/4
Authorization: Bearer {{adminToken}}
Content-Type: {{contentType}}

{
  "description": "Editor de contenido actualizado"
}

###
# 16. ELIMINAR ROL (ADMIN)
DELETE {{baseUrl}}/roles/4
Authorization: Bearer {{adminToken}}

###
# 17. VERIFICAR APLICACIÃ“N FUNCIONANDO
GET {{baseUrl}}
